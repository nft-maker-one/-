# DEX（Decentralized exchange）模式大对比
## 背景
随着中心化交易所如ftx，以及各类银行（如硅谷银行，第一共和国的银行）最近的不断暴雷。CEX的安全性进来也不断受到人们质疑，所以DEX这个之前被大家高高捧起有重重率先的概率也重新回到了
大众的视野中。其实我个人认为这也未尝不是好事，任何一件东西无论再好，只有戳破泡沫之后我们才能真正冷静的从价值的角度对其进行评判，而非进行炒作。这对DEX长期的发展来看也是一个重要的蛰伏
窗口，戳破泡沫，我们才能发现问题，重新出发。
## Uniswap
### 流动性池
流动性池是Uniswap智能合约上的代币准备金，大家可以想象成银行中人民币和美金的储蓄。uniswap中流动性池的原始流动性由流动性提供者提供，相应的，没完成一笔交易，流动性提供者也可以获得0.3%的交易手续费的部分分成。而当用户在uniswap上每进行一次交易就会带来流动性池的变化。
比如原来的流动性池中有100枚ETH和10000枚USDT，用户发送来一枚ETH交换，得到99.009枚USDT，此时流动性池中便剩下了101枚ETH和9900.99枚USDT。那么你可能会问，为什么1枚ETH可以交换
出99.009枚USDT，而不是100枚或者101枚呢。这就涉及到uniswap中流动性池的计价机制，自动做市商机制了。
### 自动做市商（Automated Market Maker）
还是以刚才的例子
原始的流动性池中
| |ETH|USDT|K（乘积）|
|---|---|---|---|
|交换前|100|10000|1000000|

此时用户存入了1个ETH，因而流动性池中ETH总数相应变为101，为了保证K值的恒定，USDT总量应该相应变为1000000/101=9900.99。因而用户可以获得10000-9900.99=99.009个USDT

| |ETH|USDT|K（乘积）|
|---|---|---|---|
|交换后|101|9900.99|1000000|
## dydx
不同于Uniswap的自动做市商模式，dydx 采用的是订单薄模式。并且引入了保证金机制，使得用户可以进行最高20倍杠杆交易。（但对普通人也不是什么好事，普通人一定要珍爱生命，远离杠杆）
dYdX协议旨在创建一个去中心化的交易和借贷协议，通过使用链下订单簿和链上结算，实现更高效、公平和无需信任的金融市场。与Compound类似，dYdX协议允许用户提供资产以赚取利息，同时也可以借入资产。
### 抵押率
dydx只支持超额抵押贷款，当质押率（比如你质押eth，来获取100USDT，假设你的eth现在价值120usdt，质押率就是120%）低于115%时，质押品将自动出售，直至覆盖其头寸。
### 混合订单簿
dydx中使用了混合订单簿的模式，订单簿是按照价格水平组织排列，展示特定资产买卖订单的电子列表，订单簿列出了各价格点的要价或出价订单数量，也称为“深度”。下图为一个订单簿的示例34522表示当前价格，上面的红色数据表示的是在某个价格处的卖单数量，而下面的绿色数据则表示在某个价格处的卖单数量

![订单簿示例](https://support.pexpay.com/hc/article_attachments/9409669898137/52.png)

订单簿是中心化交易所中常用的交易模式。那么什么是混合订单簿模式呢，混合订单簿模式即链下进行订单撮合，链上进行交易结算。那么为什么不在链上完成所有过程呢，要知道在区块链上为了追求相对的安全性，是以相对的效益为代价的，链上写入一笔交易成本很高，因而dydx中仅将最为重要的交易结算环节放在链上进行，而将相对需要更多更改的挂单，匹配环节放在了链下进行。这样大大提高了交易的效率，并减少了单笔交易的成本。但是在链下订单撮合的环节，由于是由项目方进行管理，因而削弱了去中心化性，所以dydx是在一定程度上牺牲了安全性来换取效率和成本的降低


